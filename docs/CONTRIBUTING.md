# 🤝 CONTRIBUTING — an0mas-discord-bot
_最終更新: 2025-09-10 JST_

このプロジェクトへの貢献ありがとうございます！最小のコストで安全に前進するため、以下のルールに従ってください。

---

## 1. 開発環境
- **JDK**: 版本は `pom.xml` を正とする（例: 17+）。
- **ビルド**: Maven（`mvn -q clean package` など）。
- **実行**: `java -jar target/<artifact>.jar`。

---

## 2. 作業の流れ
1. Issue / RFC を作成（小変更は PR 直でもOK）。  
2. ブランチ作成: `feature/<短い説明>` / `fix/<短い説明>`。  
3. 変更は **最小差分** を徹底（既存命名/構成は維持）。  
4. PR を作成し、テンプレートに従って記載。  
5. レビュー → 修正 → マージ。

> **会話モード**（ChatGPT と作業する場合）：  
> - **セーフ**… 局所修正・ユーティリティ小追加のみ（コードは最小）。  
> - **RFC**… 根本見直しやライブラリ導入は提案のみ（移行/影響/ロールバック/参考URL）。

---

## 3. コーディング規約（要点）
- **命名/構成は原則維持**。壊す変更はまず RFC 提案。  
- **DB アクセスは `DatabaseHelper` 経由**。新レイヤ追加は提案段階で検討。  
- 例外時は **日本語・短文・エフェメラル** でユーザーへ応答。  
- Slash コマンドは `*Command`（`BaseCommand` 継承）で実装。  
- ボタンIDは `domain:action:arg1...`。発行者一致/期限切れチェック。  
- ログは INFO/WARN/ERROR を使い分ける。

---

## 4. テスト/動作確認（最低限）
- 新規コマンド: `/help` に説明追加（必要なら）。  
- エラー経路: 権限なし / DM 禁止 / 例外時のユーザー文言を確認。  
- ページング: 先頭/末尾ページのボタン状態。  
- DB: 主要テーブルへの CRUD が成功すること。

---

## 5. コミット/PR
- **コミットメッセージ**（推奨: Conventional Commits 簡易版）  
  - `feat: 機能追加` / `fix: バグ修正` / `refactor: リファクタ` / `docs: 文書` / `chore: 雑務`  
- **PR テンプレ（コピペ）**
  ```md
  ## 目的
  （何を解決する？）

  ## 変更点
  - （箇条書きで）

  ## 影響範囲
  - （ユーザー向け/運用/互換性）

  ## 動作確認
  - （コマンド実行例 / スクショ）

  ## リスクとロールバック
  - （想定リスクと戻し方）

  ## 関連
  - Issue: #123 / 参考: URL
  ```

---

## 6. RFC テンプレ
```md
# RFC: タイトル
## 現状の課題
- 最大3点

## 変更案（要点・期待効果）
- 何をどう変える？

## 互換策
- Wrapper / Deprecated / 段階移行 など

## 移行手順
- Step1 → Step2 → ...

## リスク＆ロールバック
- 各1行

## 参考URL
- 1〜4件（一次情報優先）
```

---

## 7. ドキュメント更新
- 仕様変更があれば **`docs/SPEC.md` を先に更新** → 実装を追従。  
- アーキ変更は **`docs/ARCHITECTURE.md`** も更新。  
- README にリンクを追加/修正。

---

## 8. セキュリティ・その他
- Token/秘密鍵はコミットしない（`.env` 等で管理）。  
- セキュリティ関連の報告は Issue ではなくオーナーに直接連絡。  
- ライセンス/著作権はリポジトリの LICENSE を確認。
